---
description: LAST_LOG_CURSOR 이후의 프롬프트/응답을 가공 없이 PROMPT.md에 append하고 커서를 업데이트
allowed-tools: Read, Edit
argument-hint: (선택) 특정 세션 번호나 메모
---

## PROMPT.md 업데이트 (원문 로그 기록)

LAST_LOG_CURSOR 이후에 발생한 모든 대화를 **가공 없이 원문 그대로** `docs/PROMPT.md`에 append하고 커서를 현재 시점으로 업데이트합니다.

### 핵심 원칙

- **가공 금지**: 요약, 편집, 재작성 없이 원문 그대로 기록
- **중복 방지**: LAST_LOG_CURSOR 이후의 대화만 append
- **커서 업데이트**: 기록 완료 후 현재 시점으로 커서 갱신
- **세션 구분**: 새 세션 시작 시 세션 번호와 날짜 헤더 추가

### 실행 단계

#### Step 1: 현재 PROMPT.md 읽기

`docs/PROMPT.md`를 읽어서:
- 현재 LAST_LOG_CURSOR 시점 확인
- 마지막 세션 번호 확인
- 파일 구조 파악

```markdown
<!-- LAST_LOG_CURSOR: 2026-02-08T01:45:00+09:00 -->
```

#### Step 2: 새 세션 판단

현재 대화가 새로운 세션인지 확인:
- 이전 커서 이후 시간이 30분 이상 경과했거나
- 사용자가 명시적으로 새 세션이라고 언급했거나
- `/compact` 명령어가 실행된 경우

→ 새 세션이면 헤더 추가:

```markdown
---

## 세션 N (2026-02-08)

### [시작 시각] 사용자
...
```

#### Step 3: 대화 내용 Append

커서 시점 **이후**에 발생한 모든 대화를 다음 형식으로 추가:

```markdown
### [HH:MM] 사용자
{사용자 메시지 원문}

### [HH:MM] Claude
{Claude 응답 원문}
```

**중요**:
- 코드 블록은 그대로 유지 (백틱 트리플 포함)
- 도구 호출은 생략하지 말고 그대로 기록
- 시스템 메시지나 경고는 제외
- **가공, 요약, 의역 절대 금지**

#### Step 4: 커서 업데이트

파일 맨 하단에 새로운 커서를 추가:

```markdown
<!-- LAST_LOG_CURSOR: 2026-02-08T14:30:00+09:00 -->
```

현재 시점을 `YYYY-MM-DDTHH:MM:SS+09:00` 형식 (KST)으로 기록합니다.

#### Step 5: 파일 저장 및 확인

- `Edit` 도구로 변경사항 적용
- 추가된 대화 수 보고
- 새 커서 시점 표시

### 출력 형식

완료 후 다음 정보를 출력:

```
✅ **PROMPT.md 업데이트 완료!**

📝 **추가된 대화**:
- 사용자 메시지: N건
- Claude 응답: N건

🕐 **커서 업데이트**:
- 이전: 2026-02-08T01:45:00+09:00
- 현재: 2026-02-08T14:30:00+09:00

📂 **파일**: docs/PROMPT.md
```

### 주의사항

1. **원문 보존**: 절대로 내용을 수정, 요약, 재작성하지 않습니다
2. **중복 방지**: 이미 기록된 대화는 다시 추가하지 않습니다
3. **시간 정확성**: KST(Asia/Seoul) 기준으로 시간을 기록합니다
4. **세션 구분**: 새 세션은 명확한 헤더로 구분합니다

### 예외 처리

- PROMPT.md가 없으면 → 새로 생성
- 커서가 없으면 → 파일 전체를 첫 세션으로 간주
- 커서 이후 대화가 없으면 → "기록할 새 대화가 없습니다" 메시지 출력

### ARGUMENTS 처리

`$ARGUMENTS`가 제공되면:
- 세션 번호로 간주 (예: "8" → 세션 8)
- 또는 메모로 기록 (예: "백엔드 배포 완료" → 세션 헤더에 추가)

예:
```markdown
## 세션 8 (2026-02-08) - 백엔드 배포 완료
```
